<div class="container">
  <app-utilities (clickSave)="SaveChanges()"
   (clickPopup)="openPopup()" (delete)="invoiceDelete(id)"
    [name]="pageName"></app-utilities>

  <form #myForm="ngForm" class="page__content shadow p-3 page__content-data">
    <div class="container-fluid">
      <div class="bg-white border rounded p-3">
        <div class="row">
          <div class="col-md-8">
            <div class="row controlRow">
              <div class="col-sm-1">
                <label class="small float-right pt-2">رقم الفئة</label>
              </div>
              <div class="col-sm-4">
                <div class="d-flex txtStore">
                  <input type="text" class="form-control form-control-sm w-25 d-none txtStoreId"
                    [(ngModel)]="lookupItemDetails.code" name="txtStoreId" />

                  <input type="text" class="form-control form-control-sm w-25 txtStoreCode"
                    (dblclick)="openModal(templateCategories)"
                    (change)="lookupDetailsGetBylookupId(lookupItemDetails.code)"
                    [ngClass]="{'is-invalid': (!lookupItemDetails.code) && (lookupItemDetails.code==0)&& (lookupItm.touched || lookupItm.dirty)}"
                    #lookupItm="ngModel" [(ngModel)]="lookupItemDetails.code" name="txtStoreCode" required
                    placeholder="0" />

                  <input type="text" id="start" class="form-control form-control-sm txtStoreName" readonly
                    [(ngModel)]="lookupItemDetails.nameL1" name="txtStoreName" required placeholder="أسم الفئة" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
  <!-- Button trigger modal -->
  <br/>
<h1>ارقام حساب الفئات</h1>
  <table class="table table-striped table-inverse table-responsive">
    <thead class="thead-inverse">
      <tr>
        <th>إضافة</th>
        <th class="indexStyle">العمله</th>
        <th>اسم العمله</th>
        <th>حساب المبيعات</th>
        <th>حساب مردود المبيعات</th>
        <th>حساب الخصم المكتسب</th>
        <th>حساب الخصم المسموح</th>
        <th>حساب ضريبه المبيعات</th>
        <th>حساب ضريبة المدين</th>
        <th>حساب ضريبة الدائن</th>
        <th>حذف</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of list let indexOfelement=index;">
        <td>
          <button type="button" name="" id="" class="btn btn-outline-primary btn-sm" (click)="addNewRow()"><i class="fa fa-plus"></i></button>
        </td>
        <td>
          <input type="text" class="form-control form-control-sm indexStyle" (dblclick)="openModal(currencyTemplete)"
            (change)="lookupDetailsGetBylookupId(list[indexOfelement].curCode)"
            [ngClass]="{'is-invalid': (!list[indexOfelement].curCode) && (list[indexOfelement].curCode==0)&& (currencyItm.touched || currencyItm.dirty)}"
            #currencyItm="ngModel" [(ngModel)]="list[indexOfelement].curCode" name="txtStoreCode" required placeholder="0" />
        </td>
         <td>
          <input  type="text" class="form-control form-control-sm"
           disabled="true" [(ngModel)]="item.curName"
            name="currencyName" placeholder="أسم العملة" />
        </td>
        <td>
        <!-- حساب المبيعات -->
          <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,1)"
            [ngClass]="{'is-invalid': (!item.catSellAccNumber) && (item.catSellAccNumber=='')&& (accountItm1.touched || accountItm1.dirty)}"
            #accountItm1="ngModel" [(ngModel)]="item.catSellAccNumber" name="txtStoreCode" required
            placeholder="انقر مرتين " />
        </td>
        <td>
          <!--  حساب مردود المبيعات -->
          <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,2)"
            [ngClass]="{'is-invalid': (!item.catBackBuyAccNumber) && (item.catBackBuyAccNumber=='')&& (accountItm2.touched || accountItm2.dirty)}"
            #accountItm2="ngModel" [(ngModel)]="item.catBackBuyAccNumber" name="txtStoreCode" required
            placeholder="انقر مرتين " />
        </td>
        <td>
          <!-- حساب الخصم المكتسب -->
          <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,3)"
            [ngClass]="{'is-invalid': (!item.catDiscAccNumber) && (item.catDiscAccNumber=='')&& (accountItm3.touched || accountItm3.dirty)}"
            #accountItm3="ngModel" [(ngModel)]="item.catDiscAccNumber" name="txtStoreCode" required
            placeholder="انقر مرتين " />
        </td>
        <td>
          <!-- حساب الخصم المسموح به -->
          <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,4)"
            [ngClass]="{'is-invalid': (!item.catInDiscAccNumber) && (item.catInDiscAccNumber=='')&& (accountItm4.touched || accountItm4.dirty)}"
            #accountItm4="ngModel" [(ngModel)]="item.catInDiscAccNumber" name="txtStoreCode" required
            placeholder="انقر مرتين " />
        </td>
        <td>
          <!-- حساب ضريبه المبيعات -->
          <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,5)"
            [ngClass]="{'is-invalid': (!item.catTaxAccNumber) && (item.catTaxAccNumber=='')&& (accountItm5.touched || accountItm5.dirty)}"
            #accountItm5="ngModel" [(ngModel)]="item.catTaxAccNumber" name="txtStoreCode" required
            placeholder="انقر مرتين " />
        </td>
        <td>
          <!-- حساب ضريبه المدين -->
          <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,6)"
            [ngClass]="{'is-invalid': (!item.vatDebitAccNumber) && (item.vatDebitAccNumber=='')&& (accountItm9.touched || accountItm9.dirty)}"
            #accountItm9="ngModel" [(ngModel)]="item.vatDebitAccNumber" name="txtStoreCode" required
            placeholder="انقر مرتين " />
        </td>
       <td>
         <!-- حساب ضريبه الدائن -->
          <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,7)"
            [ngClass]="{'is-invalid': (!item.vatCreditAccNumber) && (item.vatCreditAccNumber=='')&& (accountItm10.touched || accountItm10.dirty)}"
            #accountItm10="ngModel" [(ngModel)]="item.vatCreditAccNumber" name="txtStoreCode" required
            placeholder="انقر مرتين " />
        </td>

        <td>
          <button type="button" name="" id="" class="btn btn-outline-danger btn-sm"><i class="fa fa-trash"></i></button>
        </td>
      </tr>



    </tbody>
  </table>


  <h2>حساب بعمله المخزون</h2>

  <div class="container-fluid">
    <div class="bg-white border rounded p-3">
      <div class="row">
        <div class="row">
          <div class="col">
              <label class="small float-right pt-2">حساب المجموعه</label>
              <div class="d-flex txtStore">
                <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,8)"
            [ngClass]="{'is-invalid': (!catGroupAcc.accountNo) && (catGroupAcc.accountNo=='')&& (accountItm6.touched || accountItm6.dirty)}"
            #accountItm6="ngModel" [(ngModel)]="catGroupAcc.accountNo" name="txtStoreCode" required
            placeholder="انقر مرتين للاختيار" />
              </div>
          </div>
          <div class="col">
              <label class="small float-right pt-2">حساب مردود المشتريات  </label>
              <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,9)"
            [ngClass]="{'is-invalid': (!catBackSellAcc.accountNo) && (catBackSellAcc.accountNo=='')&& (accountItm7.touched || accountItm7.dirty)}"
            #accountItm7="ngModel" [(ngModel)]="catBackSellAcc.accountNo" name="txtStoreCode" required
            placeholder="انقر مرتين للاختيار"/>
          </div>
          <div class="col">
              <label class="small float-right pt-2">حساب تكلفة المبيعات</label>
              <input readonly type="text" class="form-control form-control-sm " (dblclick)="openModal(AccountTemplete,10)"
            [ngClass]="{'is-invalid': (!catCostAcc.accountNo) && (catCostAcc.accountNo=='')&& (accountItm8.touched || accountItm8.dirty)}"
            #accountItm8="ngModel" [(ngModel)]="catCostAcc.accountNo" name="txtStoreCode" required
            placeholder="انقر مرتين للاختيار" />
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



<!-- Categories Modal -->
<ng-template #templateCategories>
  <div class="modal-content">
    <div class="modal-header">
      <h4 class="modal-title" style="color: black;">مركز الفئات</h4>
      <button type="button" class="btn-close close" aria-label="Close" (click)="modalRef?.hide()">
        <span aria-hidden="true" class="visually-hidden">&times;</span>
      </button>

    </div>
    <div class="modal-body">
      <p>
        <input type="text" placeholder="{{'search'|translate}}" [(ngModel)]="textFilterModel"
          class="form-control col-md-6">
      </p>
      <table class="table">
        <tbody>
          <tr *ngFor="let item of lookupDetailsList | lookupCategoryFilter:textFilterModel, let i =index"
            class='clickable-row' (dblclick)="getItem(item,1);modalRef?.hide()">
            <td scope="row">{{item.code}}</td>
            <td>{{item.nameL1}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-danger" (click)="modalRef.hide()">اغلاق</button>
    </div>
  </div>
</ng-template>


<!-- Currency Modal -->
<ng-template #currencyTemplete>
  <div class="modal-content">
    <div class="modal-header">
      <h4 class="modal-title" style="color: black;">العملات</h4>
      <button type="button" class="btn-close close" aria-label="Close" (click)="modalRef?.hide()">
        <span aria-hidden="true" class="visually-hidden">&times;</span>
      </button>

    </div>
    <div class="modal-body">
      <p>
        <input type="text" placeholder="{{'search'|translate}}" [(ngModel)]="textFilterModel"
          class="form-control col-md-6">
      </p>
      <table class="table">
        <tbody>
          <tr *ngFor="let item of currencyList | currencyfilter:textFilterModel, let i =index" class='clickable-row'
            (dblclick)="getItem(item,2);modalRef?.hide()">
            <td scope="row">{{item.code}}</td>
            <td>{{item.nameL1}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-danger" (click)="modalRef.hide()">اغلاق</button>
    </div>
  </div>
</ng-template>

<!-- Account Modal -->
<ng-template #AccountTemplete>
  <div class="modal-content">
    <div class="modal-header">
      <h4 class="modal-title" style="color: black;">العملات</h4>
      <button type="button" class="btn-close close" aria-label="Close" (click)="modalRef?.hide()">
        <span aria-hidden="true" class="visually-hidden">&times;</span>
      </button>

    </div>
    <div class="modal-body">
      <p>
        <input type="text" placeholder="{{'search'|translate}}" [(ngModel)]="textFilterModel"
          class="form-control col-md-6">
      </p>
      <table class="table">
        <tbody>
          <tr *ngFor="let item of accountList | accountfilter:textFilterModel, let i =index" class='clickable-row'
            (dblclick)="getItem(item,3);modalRef?.hide()">
            <td scope="row">{{item.accountNo}}</td>
            <td>{{item.nameL1}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-danger" (click)="modalRef.hide()">اغلاق</button>
    </div>
  </div>
</ng-template>
